import{q as w,r as t,j as a,Y as G,b as c}from"./app-yAQSJtCB.js";import{A as M}from"./AuthenticatedLayout-DmX7Er2P.js";import N from"./ProfileHeader-D68Jmefu.js";import P from"./ProfileTabs-S6cP0KAm.js";import V from"./GCashRedemptionModal-UQniJBS3.js";import{s as n}from"./index-Q2CZieaY.js";import"./index-BYFAk2Se.js";import"./KeyCode-BIBQ-5iG.js";import"./responsiveObserver-rdbm8B_r.js";import"./asyncToGenerator-C_xl3FJK.js";import"./index-Da8wmaTs.js";import"./useBreakpoint-CJLoZEi_.js";import"./row-BEATd-KS.js";import"./compact-item-BE9vaOuG.js";import"./useZIndex-q4v-gC99.js";import"./EllipsisOutlined-BYQeCM5H.js";import"./PurePanel-C9Zqf5xI.js";import"./index-CUWDS_la.js";import"./index-BkIKpbYi.js";import"./colors-fiVX3SUh.js";import"./collapse-BbEVqHco.js";import"./index-CIffzKKO.js";import"./UserOutlined-hEF-vAwg.js";import"./SettingOutlined-DDTq5MXy.js";import"./button-D34w74xY.js";import"./render-Duf7NqYX.js";import"./proxy-ckqmZRsA.js";import"./index-iLf87DAY.js";import"./index-CslPd_U1.js";import"./index-BjySX_8k.js";import"./CheckCircleFilled-BFKCfje8.js";import"./InfoCircleFilled-bkiPkIcd.js";import"./useClosable-nnzSN9h_.js";import"./Skeleton-Cz5FKXUf.js";import"./fade-COGsLr8a.js";import"./CalendarOutlined-ttbhfEJR.js";import"./index-cYkKODgp.js";import"./index-DWfAgPXp.js";import"./EyeOutlined-Buow9Ohn.js";import"./progress-DVmWtjW3.js";import"./ProfileInfo-BVRdkuvm.js";import"./HeartOutlined-DNcNniUY.js";import"./TeamOutlined-DkTe9iEj.js";import"./InfoCircleOutlined-Bt8H_qSJ.js";import"./PhoneOutlined-BLgCqqSr.js";import"./UserEvents-BSZs1UhQ.js";import"./index-CUhORKjj.js";import"./EnvironmentOutlined-D19lJcPo.js";import"./UserPoints-Cb6esgFk.js";import"./TrophyOutlined-MZLfZf2j.js";import"./UpdateProfileInformationForm-CwWjDbtk.js";import"./TextInput-B42S8r0w.js";import"./InputLabel-qhMcvyPN.js";import"./PrimaryButton-B04iQsMV.js";import"./transition-B47yGRa1.js";import"./UpdatePasswordForm-DwsnYY_b.js";import"./DeleteUserForm-BO5lov_b.js";import"./index-DPmbN7dd.js";import"./index-Cj9wS-7M.js";import"./index-BEIsJxv2.js";import"./context-BXHvT865.js";function Be({mustVerifyEmail:v,status:E}){const{user:r,personalInformation:O,educationalBackground:R,additionalInformation:j,emergencyContact:x}=w().props,[y,p]=t.useState(!1),[m,b]=t.useState(null),[d,S]=t.useState(""),[l,_]=t.useState(""),[u,f]=t.useState({data:[],loading:!0,error:null}),[h,g]=t.useState({data:[],loading:!0,error:null});t.useEffect(()=>{(async()=>{try{const e=await c.get(route("your.events.fetch"),{headers:{Accept:"application/json"}});f({data:e.data||[],loading:!1,error:null})}catch(e){console.error("Full error:",e),e.response?(console.error("Response error:",e.response.data),console.error("Status code:",e.response.status)):e.request?console.error("No response received:",e.request):console.error("Error setting up request:",e.message),f({data:[],loading:!1,error:e.message||"Failed to fetch events"}),n.error("Error fetching events: "+e.message)}})()},[]),t.useEffect(()=>{(async()=>{try{const i=((await c.get(route("gcash.redemption.configs"),{headers:{Accept:"application/json","Content-Type":"application/json"}})).data||[]).filter(s=>s.points_required!==void 0&&s.gcash_amount!==void 0&&s.is_active).map(s=>({points:s.points_required,amount:s.gcash_amount}));g({data:i,loading:!1,error:null})}catch(e){console.error("Error fetching redemption options:",e),g({data:[],loading:!1,error:e.message||"Failed to fetch redemption options"}),n.error("Failed to load redemption options")}})()},[]);const C=o=>{(r==null?void 0:r.youth_points)>=o.points?(b(o),p(!0)):n.warning("Insufficient points for this redemption.")},q=async()=>{var o,e;try{const i=await c.post(route("gcash.redeem"),{points:m.points,amount:m.amount,gcash_name:d,gcash_number:l});n.success(i.data.message),p(!1)}catch(i){n.error(((e=(o=i.response)==null?void 0:o.data)==null?void 0:e.message)||"Redemption failed")}};return a.jsxs(M,{user:r,children:[a.jsx(G,{title:"View Profile"}),a.jsx(N,{user:r}),a.jsx(P,{user:r,personalInformation:O,educationalBackground:R,additionalInformation:j,emergencyContact:x,userEvents:u.data,isLoadingEvents:u.loading,redemptionOptions:h.data,isLoadingOptions:h.loading,handleOpenGCashModal:C,mustVerifyEmail:v,status:E}),a.jsx(V,{isVisible:y,onClose:()=>p(!1),selectedOption:m,gcashName:d,setGcashName:S,gcashNumber:l,setGcashNumber:_,onRedeem:q})]})}export{Be as default};
