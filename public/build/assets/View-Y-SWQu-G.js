import{q as w,r as t,j as a,Y as G,b as c}from"./app-qL-fdGey.js";import{A as M}from"./AuthenticatedLayout-nhmvArNR.js";import N from"./ProfileHeader-BbogwKoc.js";import P from"./ProfileTabs-D0tm8cqA.js";import V from"./GCashRedemptionModal-S_LDxBuZ.js";import{s as n}from"./index-g-LoenzQ.js";import"./index-N2LMB4J3.js";import"./KeyCode-BcMkxFvq.js";import"./responsiveObserver-5zExmYE5.js";import"./asyncToGenerator-Dbx0A25t.js";import"./index-CC9fO9kx.js";import"./useBreakpoint-27WuVI5t.js";import"./row-B-YgVvoO.js";import"./compact-item-DQdXs6GY.js";import"./useZIndex-S1lHx0GG.js";import"./EllipsisOutlined-CIEFkY4E.js";import"./PurePanel-JVzz44JH.js";import"./index-CUWDS_la.js";import"./index-p-iUvWS7.js";import"./colors-CF-IU4tS.js";import"./collapse-BbEVqHco.js";import"./index-BAoBG6ee.js";import"./UserOutlined-BIWhzec7.js";import"./SettingOutlined-DRQlrnJ8.js";import"./button-BfZ4ATKu.js";import"./render-CANeGeGv.js";import"./proxy-Cu4yFZdd.js";import"./index-BnfLxPNj.js";import"./index-C-Pv2VtD.js";import"./index-BX4xBb0x.js";import"./CheckCircleFilled-DRkdd0YH.js";import"./InfoCircleFilled-D4JZBJsP.js";import"./useClosable-qDp0RFUc.js";import"./Skeleton-C4LSj1PC.js";import"./fade-DUlxjhZa.js";import"./CalendarOutlined-Ccp23IWQ.js";import"./index-D36folzA.js";import"./index-qdnwg9BK.js";import"./EyeOutlined-DeG1pMF8.js";import"./progress-COXIOWvu.js";import"./ProfileInfo-h4vb37xf.js";import"./HeartOutlined-D-7PIt4-.js";import"./TeamOutlined-_7N0b6aX.js";import"./InfoCircleOutlined-D3KTfC3G.js";import"./PhoneOutlined-cSrE6K-Q.js";import"./UserEvents-P4DpDgQF.js";import"./index-B8y8Xk7X.js";import"./EnvironmentOutlined-BlF_hRCd.js";import"./UserPoints-ATw_FyHD.js";import"./TrophyOutlined-GoQwH_fp.js";import"./UpdateProfileInformationForm-NFWimfEA.js";import"./TextInput-BwHtdxkN.js";import"./InputLabel-BHISvQaK.js";import"./PrimaryButton-B8kmu3H_.js";import"./transition-C4PNrJ0_.js";import"./UpdatePasswordForm-CkStzhO9.js";import"./DeleteUserForm-CMI_GLMT.js";import"./index-D2qDBgss.js";import"./index-CAALibYJ.js";import"./index-BGElmBMO.js";import"./context-DjqbUx1D.js";function Be({mustVerifyEmail:v,status:E}){const{user:r,personalInformation:O,educationalBackground:R,additionalInformation:j,emergencyContact:x}=w().props,[y,p]=t.useState(!1),[m,b]=t.useState(null),[d,S]=t.useState(""),[l,_]=t.useState(""),[u,f]=t.useState({data:[],loading:!0,error:null}),[h,g]=t.useState({data:[],loading:!0,error:null});t.useEffect(()=>{(async()=>{try{const e=await c.get(route("your.events.fetch"),{headers:{Accept:"application/json"}});f({data:e.data||[],loading:!1,error:null})}catch(e){console.error("Full error:",e),e.response?(console.error("Response error:",e.response.data),console.error("Status code:",e.response.status)):e.request?console.error("No response received:",e.request):console.error("Error setting up request:",e.message),f({data:[],loading:!1,error:e.message||"Failed to fetch events"}),n.error("Error fetching events: "+e.message)}})()},[]),t.useEffect(()=>{(async()=>{try{const i=((await c.get(route("gcash.redemption.configs"),{headers:{Accept:"application/json","Content-Type":"application/json"}})).data||[]).filter(s=>s.points_required!==void 0&&s.gcash_amount!==void 0&&s.is_active).map(s=>({points:s.points_required,amount:s.gcash_amount}));g({data:i,loading:!1,error:null})}catch(e){console.error("Error fetching redemption options:",e),g({data:[],loading:!1,error:e.message||"Failed to fetch redemption options"}),n.error("Failed to load redemption options")}})()},[]);const C=o=>{(r==null?void 0:r.youth_points)>=o.points?(b(o),p(!0)):n.warning("Insufficient points for this redemption.")},q=async()=>{var o,e;try{const i=await c.post(route("gcash.redeem"),{points:m.points,amount:m.amount,gcash_name:d,gcash_number:l});n.success(i.data.message),p(!1)}catch(i){n.error(((e=(o=i.response)==null?void 0:o.data)==null?void 0:e.message)||"Redemption failed")}};return a.jsxs(M,{user:r,children:[a.jsx(G,{title:"View Profile"}),a.jsx(N,{user:r}),a.jsx(P,{user:r,personalInformation:O,educationalBackground:R,additionalInformation:j,emergencyContact:x,userEvents:u.data,isLoadingEvents:u.loading,redemptionOptions:h.data,isLoadingOptions:h.loading,handleOpenGCashModal:C,mustVerifyEmail:v,status:E}),a.jsx(V,{isVisible:y,onClose:()=>p(!1),selectedOption:m,gcashName:d,setGcashName:S,gcashNumber:l,setGcashNumber:_,onRedeem:q})]})}export{Be as default};
