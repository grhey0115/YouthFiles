import{r as i,q as oe,j as e,Y as ae,y as w}from"./app-qL-fdGey.js";import{A as ce,S as a,R as le}from"./AuthenticatedLayout-nhmvArNR.js";import{d as A}from"./styled-components.browser.esm-RlmBtmMa.js";import{S as u}from"./index-CJAhixEb.js";import{R as y}from"./TeamOutlined-_7N0b6aX.js";import{A as E}from"./index-D2qDBgss.js";import{R as N,C as m}from"./row-B-YgVvoO.js";import{C as c,R as de}from"./index-D36folzA.js";import{T as R}from"./Timeline-CwDKGBtS.js";import{R as F}from"./CalendarOutlined-Ccp23IWQ.js";import{R as me}from"./EnvironmentOutlined-BlF_hRCd.js";import{D as $}from"./index-iXo93vc3.js";import{T as p}from"./index-p-iUvWS7.js";import{B as r}from"./button-BfZ4ATKu.js";import{R as P,a as L,b as M}from"./WhatsAppOutlined-BWqSW-kA.js";import{M as pe}from"./index-BX4xBb0x.js";import{I as xe}from"./index-BGElmBMO.js";import{I as U,_ as B}from"./KeyCode-BcMkxFvq.js";import{U as he,R as ue}from"./index-qdnwg9BK.js";import{T as fe}from"./index-BAoBG6ee.js";import{s as o}from"./index-g-LoenzQ.js";import{T as _}from"./index-B8y8Xk7X.js";import{P as je}from"./progress-COXIOWvu.js";import{R as ve}from"./TrophyOutlined-GoQwH_fp.js";import{R as ge}from"./DollarOutlined-Dv92HJEF.js";import{R as be}from"./asyncToGenerator-Dbx0A25t.js";import{R as we}from"./ShareAltOutlined-DFQR2cBc.js";import"./index-N2LMB4J3.js";import"./responsiveObserver-5zExmYE5.js";import"./index-CC9fO9kx.js";import"./useBreakpoint-27WuVI5t.js";import"./useZIndex-S1lHx0GG.js";import"./EllipsisOutlined-CIEFkY4E.js";import"./PurePanel-JVzz44JH.js";import"./compact-item-DQdXs6GY.js";import"./index-CUWDS_la.js";import"./collapse-BbEVqHco.js";import"./UserOutlined-BIWhzec7.js";import"./SettingOutlined-DRQlrnJ8.js";import"./proxy-Cu4yFZdd.js";import"./index-BnfLxPNj.js";import"./colors-CF-IU4tS.js";import"./index-C-Pv2VtD.js";import"./Skeleton-C4LSj1PC.js";import"./CheckCircleFilled-DRkdd0YH.js";import"./InfoCircleFilled-D4JZBJsP.js";import"./render-CANeGeGv.js";import"./useClosable-qDp0RFUc.js";import"./fade-DUlxjhZa.js";import"./EyeOutlined-DeG1pMF8.js";import"./context-DjqbUx1D.js";var ye={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},Re=function(f,l){return i.createElement(U,B({},f,{ref:l,icon:ye}))},Se=i.forwardRef(Re),Ce={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 394c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H400V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v236H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h228v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h164c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V394h164zM628 630H400V394h228v236z"}}]},name:"number",theme:"outlined"},Ie=function(f,l){return i.createElement(U,B({},f,{ref:l,icon:Ce}))},ke=i.forwardRef(Ie);const{Text:Ne}=fe,$e=A.div`
    display: none;
    @media (max-width: 992px) {
        display: block;
        margin: 16px 0;
        padding: 16px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
`,_e=A(c)`
    @media (max-width: 992px) {
        display: none;
    }
`,$t=()=>{const{event:t,user:f,isFull:l,flash:Te={},hasJoined:O,attendance_status:x,paymentStatus:V,relatedEvents:j}=oe().props,[H,z]=i.useState(V),[v,T]=i.useState(O||!1),[S,Y]=i.useState(!1),[J,g]=i.useState(!1),[b,q]=i.useState(""),[h,W]=i.useState([]),[G,C]=i.useState(!1);i.useEffect(()=>{Q()},[t]);const Q=()=>{const s=new Date,n=new Date(t.end_time);Y(s>n)},K=()=>{t.registration_fee>0?g(!0):w.post(route("events.join",t.id),{},{onSuccess:()=>{T(!0),o.success("Successfully registered for the event!")},onError:()=>o.error("Failed to register for the event.")})},X=()=>{w.post(route("events.cancel",t.id),{},{onSuccess:()=>{T(!1),o.info("Successfully cancelled your registration.")},onError:()=>o.error("Failed to cancel registration.")})},Z=async()=>{if(!b||h.length===0){o.error("Please provide all required payment details.");return}C(!0);const s=new FormData;s.append("reference_number",b),s.append("receipt",h[0].originFileObj);try{await w.post(route("events.payment",t.id),s,{onSuccess:()=>{g(!1),z("pending"),o.success("Payment submitted successfully!")},onError:()=>o.error("Failed to submit payment."),onFinish:()=>C(!1)})}catch(n){console.error("Payment error:",n),o.error("An unexpected error occurred."),C(!1)}},ee=()=>S?e.jsx(_,{color:"red",children:"Event Ended"}):l?e.jsx(_,{color:"orange",children:"Full"}):e.jsx(_,{color:"green",children:"Open for Registration"}),te=()=>{const s=new Date,n=new Date(t.start_time),k=new Date(t.end_time)-n,re=s-n,ie=Math.min(Math.max(re/k*100,0),100);return e.jsxs(c,{title:"Event Progress",className:"mb-4",children:[e.jsx(je,{percent:Number(ie.toFixed(1)),status:S?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}}),e.jsxs(N,{gutter:16,className:"mt-4",children:[e.jsx(m,{span:8,children:e.jsx(u,{title:"Registered",value:t.slots-t.available_slots,suffix:`/ ${t.slots}`,prefix:e.jsx(y,{})})}),e.jsx(m,{span:8,children:e.jsx(u,{title:"Youth Points",value:t.youth_points,prefix:e.jsx(ve,{})})}),t.registration_fee>0&&e.jsx(m,{span:8,children:e.jsx(u,{title:"Registration Fee",value:t.registration_fee,prefix:e.jsx(ge,{}),formatter:ne=>`₱${ne}`})})]})]})},D=()=>S?v&&x==="present"?e.jsx(r,{type:"primary",icon:e.jsx(ue,{}),onClick:()=>window.location.href=route("events.certificate",t.id),children:"Download Certificate"}):e.jsx(r,{disabled:!0,children:"Event Ended"}):v?e.jsx(r,{danger:!0,icon:e.jsx(Se,{}),onClick:X,children:"Cancel Registration"}):l?e.jsx(r,{disabled:!0,children:"Event is Full"}):H==="pending"?e.jsx(r,{disabled:!0,icon:e.jsx(be,{}),children:"Payment Pending"}):e.jsx(r,{type:"primary",icon:e.jsx(le,{}),onClick:K,children:t.registration_fee>0?`Register (₱${t.registration_fee})`:"Register Now"}),d=s=>{const n=window.location.href,I=encodeURIComponent(t.name);encodeURIComponent(t.description.replace(/<[^>]*>/g,""));const k={facebook:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(n)}`,twitter:`https://twitter.com/intent/tweet?text=${I}&url=${encodeURIComponent(n)}`,whatsapp:`https://api.whatsapp.com/send?text=${I}%20${encodeURIComponent(n)}`};window.open(k[s],"_blank","width=600,height=400")},se=()=>e.jsx(c,{title:e.jsxs(a,{children:[e.jsx(we,{})," Share This Event"]}),className:"mb-4",children:e.jsxs(a,{size:"middle",children:[e.jsx(p,{title:"Share on Facebook",children:e.jsx(r,{type:"primary",shape:"circle",icon:e.jsx(P,{}),onClick:()=>d("facebook"),style:{backgroundColor:"#1877f2"}})}),e.jsx(p,{title:"Share on Twitter",children:e.jsx(r,{type:"primary",shape:"circle",icon:e.jsx(L,{}),onClick:()=>d("twitter"),style:{backgroundColor:"#1da1f2"}})}),e.jsx(p,{title:"Share on WhatsApp",children:e.jsx(r,{type:"primary",shape:"circle",icon:e.jsx(M,{}),onClick:()=>d("whatsapp"),style:{backgroundColor:"#25d366"}})})]})});return e.jsxs(ce,{children:[e.jsx(ae,{title:t.name}),e.jsxs("div",{className:"relative h-[400px] w-full mb-8",children:[e.jsx("img",{src:`/storage/${t.header_image}`,alt:t.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:t.name}),ee()]})})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx($e,{children:e.jsxs(a,{direction:"vertical",className:"w-full",children:[D(),e.jsx(u,{title:"Available Slots",value:t.available_slots,suffix:`/ ${t.slots}`,prefix:e.jsx(y,{})}),v&&e.jsx(E,{message:"Registration Status",description:x==="present"?"You have attended this event":"You are registered for this event",type:x==="present"?"success":"info",showIcon:!0})]})}),e.jsxs(N,{gutter:[24,24],children:[e.jsxs(m,{xs:24,lg:16,children:[te(),e.jsx(c,{title:"Event Details",className:"mb-4",children:e.jsxs(R,{children:[e.jsxs(R.Item,{dot:e.jsx(F,{}),children:[e.jsxs("p",{children:["Date: ",new Date(t.start_time).toLocaleDateString()]}),e.jsxs("p",{children:["Time: ",new Date(t.start_time).toLocaleTimeString()," - ",new Date(t.end_time).toLocaleTimeString()]})]}),e.jsx(R.Item,{dot:e.jsx(me,{}),children:e.jsxs("p",{children:["Location: ",t.location]})}),e.jsx(R.Item,{children:e.jsx("div",{dangerouslySetInnerHTML:{__html:t.description}})})]})}),se(),(j==null?void 0:j.length)>0&&e.jsx(c,{title:"Related Events",className:"mb-4",children:e.jsx(N,{gutter:[16,16],children:j.map(s=>e.jsx(m,{xs:24,sm:12,md:8,children:e.jsx(c,{hoverable:!0,cover:e.jsx("img",{alt:s.name,src:`/storage/${s.header_image}`,className:"h-48 object-cover"}),onClick:()=>w.visit(route("events.show",s.id)),children:e.jsx(c.Meta,{title:s.name,description:e.jsxs(a,{direction:"vertical",children:[e.jsxs("span",{children:[e.jsx(F,{})," ",new Date(s.start_time).toLocaleDateString()]}),e.jsxs("span",{children:[e.jsx(y,{})," ",s.available_slots," slots left"]})]})})})},s.id))})})]}),e.jsx(m,{xs:24,lg:8,children:e.jsx(_e,{className:"sticky top-4",children:e.jsxs(a,{direction:"vertical",className:"w-full",children:[D(),e.jsx($,{}),e.jsx(u,{title:"Available Slots",value:t.available_slots,suffix:`/ ${t.slots}`,prefix:e.jsx(y,{})}),v&&e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx(E,{message:"Registration Status",description:x==="present"?"You have attended this event":"You are registered for this event",type:x==="present"?"success":"info",showIcon:!0})]}),e.jsx($,{}),e.jsxs("div",{className:"text-center",children:[e.jsx(Ne,{type:"secondary",children:"Quick Share:"}),e.jsxs(a,{className:"mt-2",children:[e.jsx(p,{title:"Share on Facebook",children:e.jsx(r,{type:"text",icon:e.jsx(P,{}),onClick:()=>d("facebook"),className:"text-[#1877f2] hover:text-[#1877f2]/80"})}),e.jsx(p,{title:"Share on Twitter",children:e.jsx(r,{type:"text",icon:e.jsx(L,{}),onClick:()=>d("twitter"),className:"text-[#1da1f2] hover:text-[#1da1f2]/80"})}),e.jsx(p,{title:"Share on WhatsApp",children:e.jsx(r,{type:"text",icon:e.jsx(M,{}),onClick:()=>d("whatsapp"),className:"text-[#25d366] hover:text-[#25d366]/80"})})]})]})]})})})]})]}),e.jsx(pe,{title:"Submit Payment",open:J,onCancel:()=>g(!1),footer:[e.jsx(r,{onClick:()=>g(!1),children:"Cancel"},"cancel"),e.jsx(r,{type:"primary",onClick:Z,loading:G,disabled:!b||h.length===0,children:"Submit Payment"},"submit")],children:e.jsxs(a,{direction:"vertical",className:"w-full",children:[e.jsx(xe,{placeholder:"Enter GCash Reference Number",value:b,onChange:s=>q(s.target.value),prefix:e.jsx(ke,{})}),e.jsx(he,{listType:"picture-card",fileList:h,onChange:({fileList:s})=>W(s),beforeUpload:()=>!1,maxCount:1,children:h.length===0&&e.jsxs("div",{children:[e.jsx(de,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Receipt"})]})})]})})]})};export{$t as default};
