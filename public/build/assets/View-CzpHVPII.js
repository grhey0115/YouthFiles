import{q as w,r as t,j as a,Y as G,b as c}from"./app-DbgwDCQR.js";import{A as M}from"./AuthenticatedLayout-wAnVCWe8.js";import N from"./ProfileHeader-D30QVlWa.js";import P from"./ProfileTabs-UHxs8l6k.js";import V from"./GCashRedemptionModal-k7WLsgwW.js";import{s as n}from"./index-Dc46TUNE.js";import"./index-Dr5FKUpM.js";import"./KeyCode-B98qwEHk.js";import"./responsiveObserver-2YMebKjr.js";import"./asyncToGenerator-1ZsjUJVg.js";import"./index-BFTNhID1.js";import"./useBreakpoint-B1vn5vaL.js";import"./row-CmTRvdGv.js";import"./compact-item-e1NxggHa.js";import"./useZIndex-tLrB1ewf.js";import"./EllipsisOutlined-DDu3pgoy.js";import"./PurePanel-DY_vS5pl.js";import"./CloseOutlined-DIR-yomB.js";import"./index-CUWDS_la.js";import"./index-CoGEig71.js";import"./colors-DJ9azOgj.js";import"./collapse-BbEVqHco.js";import"./index-DusIXW1R.js";import"./EditOutlined-CcOrQ41O.js";import"./UserOutlined-CN0QnvMs.js";import"./SettingOutlined-DkPiynSm.js";import"./button-BeIDC77s.js";import"./render-BXyLa_zz.js";import"./HomeOutlined-C7PNhMil.js";import"./index-BDhiJVo3.js";import"./index-CoH_l0tO.js";import"./CheckCircleFilled-CqKSgjp8.js";import"./ExclamationCircleFilled-DEhqqzrm.js";import"./InfoCircleFilled-DCKnBfB8.js";import"./useClosable-BI8GR9gs.js";import"./Skeleton-CDkIKx5f.js";import"./fade-DyWzk-Bk.js";import"./CalendarOutlined-CJm5NcVw.js";import"./index-aEjf0pBo.js";import"./index-CWPrh4N9.js";import"./DeleteOutlined-D6BVE3ZI.js";import"./EyeOutlined-DhfopHHq.js";import"./progress-lRO8rVRK.js";import"./ProfileInfo-DQTCNJHl.js";import"./HeartOutlined-DI_2cGtW.js";import"./TeamOutlined-DEST0Fbh.js";import"./InfoCircleOutlined-DpJkxdmQ.js";import"./PhoneOutlined-DwfgFiR6.js";import"./UserEvents-DTYPRe4M.js";import"./index-CXb-UgcJ.js";import"./EnvironmentOutlined-DepYESSt.js";import"./UserPoints-Cz_pXadF.js";import"./TrophyOutlined-jDVSXleb.js";import"./UpdateProfileInformationForm-I_V5sTLR.js";import"./TextInput-Ci3AeuCt.js";import"./InputLabel-DMh-aH3y.js";import"./PrimaryButton-CpI1mEud.js";import"./transition-D1M-jEDH.js";import"./UpdatePasswordForm-B23Juxi2.js";import"./DeleteUserForm-CJ8sxfBj.js";import"./index-f82A52t5.js";import"./index-2bkOm2FA.js";import"./index-DZ6KHcTM.js";import"./context-DlbZ9Qay.js";function ze({mustVerifyEmail:v,status:E}){const{user:r,personalInformation:O,educationalBackground:R,additionalInformation:j,emergencyContact:x}=w().props,[y,p]=t.useState(!1),[m,b]=t.useState(null),[d,S]=t.useState(""),[l,_]=t.useState(""),[u,f]=t.useState({data:[],loading:!0,error:null}),[h,g]=t.useState({data:[],loading:!0,error:null});t.useEffect(()=>{(async()=>{try{const e=await c.get(route("your.events.fetch"),{headers:{Accept:"application/json"}});f({data:e.data||[],loading:!1,error:null})}catch(e){console.error("Full error:",e),e.response?(console.error("Response error:",e.response.data),console.error("Status code:",e.response.status)):e.request?console.error("No response received:",e.request):console.error("Error setting up request:",e.message),f({data:[],loading:!1,error:e.message||"Failed to fetch events"}),n.error("Error fetching events: "+e.message)}})()},[]),t.useEffect(()=>{(async()=>{try{const i=((await c.get(route("gcash.redemption.configs"),{headers:{Accept:"application/json","Content-Type":"application/json"}})).data||[]).filter(s=>s.points_required!==void 0&&s.gcash_amount!==void 0&&s.is_active).map(s=>({points:s.points_required,amount:s.gcash_amount}));g({data:i,loading:!1,error:null})}catch(e){console.error("Error fetching redemption options:",e),g({data:[],loading:!1,error:e.message||"Failed to fetch redemption options"}),n.error("Failed to load redemption options")}})()},[]);const C=o=>{(r==null?void 0:r.youth_points)>=o.points?(b(o),p(!0)):n.warning("Insufficient points for this redemption.")},q=async()=>{var o,e;try{const i=await c.post(route("gcash.redeem"),{points:m.points,amount:m.amount,gcash_name:d,gcash_number:l});n.success(i.data.message),p(!1)}catch(i){n.error(((e=(o=i.response)==null?void 0:o.data)==null?void 0:e.message)||"Redemption failed")}};return a.jsxs(M,{user:r,children:[a.jsx(G,{title:"View Profile"}),a.jsx(N,{user:r}),a.jsx(P,{user:r,personalInformation:O,educationalBackground:R,additionalInformation:j,emergencyContact:x,userEvents:u.data,isLoadingEvents:u.loading,redemptionOptions:h.data,isLoadingOptions:h.loading,handleOpenGCashModal:C,mustVerifyEmail:v,status:E}),a.jsx(V,{isVisible:y,onClose:()=>p(!1),selectedOption:m,gcashName:d,setGcashName:S,gcashNumber:l,setGcashNumber:_,onRedeem:q})]})}export{ze as default};
