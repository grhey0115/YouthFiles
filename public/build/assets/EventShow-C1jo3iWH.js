import{r as n,q as ie,j as e,Y as oe,y as g}from"./app-DbgwDCQR.js";import{A as ae,S as d,R as ce}from"./AuthenticatedLayout-wAnVCWe8.js";import{R as I,C as p}from"./row-CmTRvdGv.js";import{C as l,R as le}from"./index-aEjf0pBo.js";import{T as v}from"./Timeline-BXFthauL.js";import{R as E}from"./CalendarOutlined-CJm5NcVw.js";import{R as me}from"./EnvironmentOutlined-DepYESSt.js";import{R as N}from"./TeamOutlined-DEST0Fbh.js";import{D as $}from"./index-LxDLPpHt.js";import{S as b}from"./index-yuXH6Ygt.js";import{A as de}from"./index-f82A52t5.js";import{T as a}from"./index-CoGEig71.js";import{B as r}from"./button-BeIDC77s.js";import{R as D,a as F,b as L,c as P}from"./WhatsAppOutlined-DaeEyyik.js";import{M as pe}from"./index-CoH_l0tO.js";import{I as he}from"./index-DZ6KHcTM.js";import{I as M,_ as U}from"./KeyCode-B98qwEHk.js";import{U as xe,R as ue}from"./index-CWPrh4N9.js";import{T as fe}from"./index-DusIXW1R.js";import{s as c}from"./index-Dc46TUNE.js";import{T as _}from"./index-CXb-UgcJ.js";import{P as je}from"./progress-lRO8rVRK.js";import{R as ge}from"./TrophyOutlined-jDVSXleb.js";import{R as ve}from"./DollarOutlined-D1hOKU2D.js";import{R as be}from"./asyncToGenerator-1ZsjUJVg.js";import{R as ye}from"./ShareAltOutlined-CYQRv0rF.js";import"./index-Dr5FKUpM.js";import"./responsiveObserver-2YMebKjr.js";import"./index-BFTNhID1.js";import"./useBreakpoint-B1vn5vaL.js";import"./useZIndex-tLrB1ewf.js";import"./EllipsisOutlined-DDu3pgoy.js";import"./PurePanel-DY_vS5pl.js";import"./compact-item-e1NxggHa.js";import"./CloseOutlined-DIR-yomB.js";import"./index-CUWDS_la.js";import"./collapse-BbEVqHco.js";import"./UserOutlined-CN0QnvMs.js";import"./SettingOutlined-DkPiynSm.js";import"./HomeOutlined-C7PNhMil.js";import"./colors-DJ9azOgj.js";import"./index-BDhiJVo3.js";import"./useClosable-BI8GR9gs.js";import"./Skeleton-CDkIKx5f.js";import"./CheckCircleFilled-CqKSgjp8.js";import"./ExclamationCircleFilled-DEhqqzrm.js";import"./InfoCircleFilled-DCKnBfB8.js";import"./render-BXyLa_zz.js";import"./fade-DyWzk-Bk.js";import"./EyeOutlined-DhfopHHq.js";import"./DeleteOutlined-D6BVE3ZI.js";import"./EditOutlined-CcOrQ41O.js";import"./context-DlbZ9Qay.js";var we={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},Re=function(x,m){return n.createElement(M,U({},x,{ref:m,icon:we}))},Se=n.forwardRef(Re),Ce={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 394c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H400V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v236H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h228v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h164c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V394h164zM628 630H400V394h228v236z"}}]},name:"number",theme:"outlined"},ke=function(x,m){return n.createElement(M,U({},x,{ref:m,icon:Ce}))},Ie=n.forwardRef(ke);const{Text:Ne}=fe,$t=()=>{const{event:t,user:x,isFull:m,flash:$e={},hasJoined:A,attendance_status:y,paymentStatus:O,relatedEvents:u}=ie().props,[V,B]=n.useState(O),[w,T]=n.useState(A||!1),[R,H]=n.useState(!1),[z,f]=n.useState(!1),[j,Y]=n.useState(""),[h,J]=n.useState([]),[q,S]=n.useState(!1);n.useEffect(()=>{W()},[t]);const W=()=>{const s=new Date,i=new Date(t.end_time);H(s>i)},G=()=>{t.registration_fee>0?f(!0):g.post(route("events.join",t.id),{},{onSuccess:()=>{T(!0),c.success("Successfully registered for the event!")},onError:()=>c.error("Failed to register for the event.")})},Q=()=>{g.post(route("events.cancel",t.id),{},{onSuccess:()=>{T(!1),c.info("Successfully cancelled your registration.")},onError:()=>c.error("Failed to cancel registration.")})},K=async()=>{if(!j||h.length===0){c.error("Please provide all required payment details.");return}S(!0);const s=new FormData;s.append("reference_number",j),s.append("receipt",h[0].originFileObj);try{await g.post(route("events.payment.store",t.id),s,{onSuccess:()=>{f(!1),B("pending"),c.success("Payment submitted successfully!")},onError:()=>c.error("Failed to submit payment."),onFinish:()=>S(!1)})}catch(i){console.error("Payment error:",i),c.error("An unexpected error occurred."),S(!1)}},X=()=>R?e.jsx(_,{color:"red",children:"Event Ended"}):m?e.jsx(_,{color:"orange",children:"Full"}):e.jsx(_,{color:"green",children:"Open for Registration"}),Z=()=>{const s=new Date,i=new Date(t.start_time),k=new Date(t.end_time)-i,se=s-i,re=Math.min(Math.max(se/k*100,0),100);return e.jsxs(l,{title:"Event Progress",className:"mb-4",children:[e.jsx(je,{percent:Number(re.toFixed(1)),status:R?"success":"active",strokeColor:{"0%":"#108ee9","100%":"#87d068"}}),e.jsxs(I,{gutter:16,className:"mt-4",children:[e.jsx(p,{span:8,children:e.jsx(b,{title:"Registered",value:t.slots-t.available_slots,suffix:`/ ${t.slots}`,prefix:e.jsx(N,{})})}),e.jsx(p,{span:8,children:e.jsx(b,{title:"Youth Points",value:t.youth_points,prefix:e.jsx(ge,{})})}),t.registration_fee>0&&e.jsx(p,{span:8,children:e.jsx(b,{title:"Registration Fee",value:t.registration_fee,prefix:e.jsx(ve,{}),formatter:ne=>`₱${ne}`})})]})]})},ee=()=>R?w&&y==="present"?e.jsx(r,{type:"primary",icon:e.jsx(ue,{}),onClick:()=>window.location.href=route("events.certificate",t.id),children:"Download Certificate"}):e.jsx(r,{disabled:!0,children:"Event Ended"}):w?e.jsx(r,{danger:!0,icon:e.jsx(Se,{}),onClick:Q,children:"Cancel Registration"}):m?e.jsx(r,{disabled:!0,children:"Event is Full"}):V==="pending"?e.jsx(r,{disabled:!0,icon:e.jsx(be,{}),children:"Payment Pending"}):e.jsx(r,{type:"primary",icon:e.jsx(ce,{}),onClick:G,children:t.registration_fee>0?`Register (₱${t.registration_fee})`:"Register Now"}),o=s=>{const i=window.location.href,C=encodeURIComponent(t.name);encodeURIComponent(t.description.replace(/<[^>]*>/g,""));const k={facebook:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(i)}`,twitter:`https://twitter.com/intent/tweet?text=${C}&url=${encodeURIComponent(i)}`,linkedin:`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(i)}`,whatsapp:`https://api.whatsapp.com/send?text=${C}%20${encodeURIComponent(i)}`};window.open(k[s],"_blank","width=600,height=400")},te=()=>e.jsx(l,{title:e.jsxs(d,{children:[e.jsx(ye,{})," Share This Event"]}),className:"mb-4",children:e.jsxs(d,{size:"middle",children:[e.jsx(a,{title:"Share on Facebook",children:e.jsx(r,{type:"primary",shape:"circle",icon:e.jsx(D,{}),onClick:()=>o("facebook"),style:{backgroundColor:"#1877f2"}})}),e.jsx(a,{title:"Share on Twitter",children:e.jsx(r,{type:"primary",shape:"circle",icon:e.jsx(F,{}),onClick:()=>o("twitter"),style:{backgroundColor:"#1da1f2"}})}),e.jsx(a,{title:"Share on LinkedIn",children:e.jsx(r,{type:"primary",shape:"circle",icon:e.jsx(L,{}),onClick:()=>o("linkedin"),style:{backgroundColor:"#0a66c2"}})}),e.jsx(a,{title:"Share on WhatsApp",children:e.jsx(r,{type:"primary",shape:"circle",icon:e.jsx(P,{}),onClick:()=>o("whatsapp"),style:{backgroundColor:"#25d366"}})})]})});return e.jsxs(ae,{children:[e.jsx(oe,{title:t.name}),e.jsxs("div",{className:"relative h-[400px] w-full mb-8",children:[e.jsx("img",{src:`/storage/${t.header_image}`,alt:t.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:t.name}),X()]})})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs(I,{gutter:24,children:[e.jsxs(p,{xs:24,lg:16,children:[Z(),e.jsx(l,{title:"Event Details",className:"mb-4",children:e.jsxs(v,{children:[e.jsxs(v.Item,{dot:e.jsx(E,{}),children:[e.jsxs("p",{children:["Date: ",new Date(t.start_time).toLocaleDateString()]}),e.jsxs("p",{children:["Time: ",new Date(t.start_time).toLocaleTimeString()," - ",new Date(t.end_time).toLocaleTimeString()]})]}),e.jsx(v.Item,{dot:e.jsx(me,{}),children:e.jsxs("p",{children:["Location: ",t.location]})}),e.jsx(v.Item,{children:e.jsx("div",{dangerouslySetInnerHTML:{__html:t.description}})})]})}),te(),(u==null?void 0:u.length)>0&&e.jsx(l,{title:"Related Events",className:"mb-4",children:e.jsx(I,{gutter:[16,16],children:u.map(s=>e.jsx(p,{xs:24,sm:12,md:8,children:e.jsx(l,{hoverable:!0,cover:e.jsx("img",{alt:s.name,src:`/storage/${s.header_image}`,className:"h-48 object-cover"}),onClick:()=>g.visit(route("events.show",s.id)),children:e.jsx(l.Meta,{title:s.name,description:e.jsxs(d,{direction:"vertical",children:[e.jsxs("span",{children:[e.jsx(E,{})," ",new Date(s.start_time).toLocaleDateString()]}),e.jsxs("span",{children:[e.jsx(N,{})," ",s.available_slots," slots left"]})]})})})},s.id))})})]}),e.jsx(p,{xs:24,lg:8,children:e.jsx(l,{className:"sticky top-4",children:e.jsxs(d,{direction:"vertical",className:"w-full",children:[ee(),e.jsx($,{}),e.jsx(b,{title:"Available Slots",value:t.available_slots,suffix:`/ ${t.slots}`,prefix:e.jsx(N,{})}),w&&e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsx(de,{message:"Registration Status",description:y==="present"?"You have attended this event":"You are registered for this event",type:y==="present"?"success":"info",showIcon:!0})]}),e.jsx($,{}),e.jsxs("div",{className:"text-center",children:[e.jsx(Ne,{type:"secondary",children:"Quick Share:"}),e.jsxs(d,{className:"mt-2",children:[e.jsx(a,{title:"Share on Facebook",children:e.jsx(r,{type:"text",icon:e.jsx(D,{}),onClick:()=>o("facebook"),className:"text-[#1877f2] hover:text-[#1877f2]/80"})}),e.jsx(a,{title:"Share on Twitter",children:e.jsx(r,{type:"text",icon:e.jsx(F,{}),onClick:()=>o("twitter"),className:"text-[#1da1f2] hover:text-[#1da1f2]/80"})}),e.jsx(a,{title:"Share on LinkedIn",children:e.jsx(r,{type:"text",icon:e.jsx(L,{}),onClick:()=>o("linkedin"),className:"text-[#0a66c2] hover:text-[#0a66c2]/80"})}),e.jsx(a,{title:"Share on WhatsApp",children:e.jsx(r,{type:"text",icon:e.jsx(P,{}),onClick:()=>o("whatsapp"),className:"text-[#25d366] hover:text-[#25d366]/80"})})]})]})]})})})]})}),e.jsx(pe,{title:"Submit Payment",open:z,onCancel:()=>f(!1),footer:[e.jsx(r,{onClick:()=>f(!1),children:"Cancel"},"cancel"),e.jsx(r,{type:"primary",onClick:K,loading:q,disabled:!j||h.length===0,children:"Submit Payment"},"submit")],children:e.jsxs(d,{direction:"vertical",className:"w-full",children:[e.jsx(he,{placeholder:"Enter GCash Reference Number",value:j,onChange:s=>Y(s.target.value),prefix:e.jsx(Ie,{})}),e.jsx(xe,{listType:"picture-card",fileList:h,onChange:({fileList:s})=>J(s),beforeUpload:()=>!1,maxCount:1,children:h.length===0&&e.jsxs("div",{children:[e.jsx(le,{}),e.jsx("div",{style:{marginTop:8},children:"Upload Receipt"})]})})]})})]})};export{$t as default};
