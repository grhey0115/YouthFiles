import{q as w,r as t,j as a,Y as G,b as c}from"./app-VLuKSNI5.js";import{A as M}from"./AuthenticatedLayout-Cn82aY-6.js";import N from"./ProfileHeader-CV4N_x62.js";import P from"./ProfileTabs-BGe2X2Uj.js";import V from"./GCashRedemptionModal-CBec9_RZ.js";import{s as n}from"./index-DmuvosGg.js";import"./index-dcLcUvdh.js";import"./KeyCode-DeqtILy9.js";import"./responsiveObserver-BSayFHpE.js";import"./asyncToGenerator-BHeHKNHv.js";import"./index-BsMMjAMk.js";import"./useBreakpoint-bE0IvSmY.js";import"./row-C0jeK4kf.js";import"./compact-item-BtH4ojeo.js";import"./useZIndex-s62uFbiD.js";import"./EllipsisOutlined-soj-txUr.js";import"./PurePanel-C9vZFy1i.js";import"./index-CUWDS_la.js";import"./index-wS7fj_p4.js";import"./colors-CKbFf4sw.js";import"./collapse-BbEVqHco.js";import"./index-B7CptjxE.js";import"./EditOutlined-0sKspUKs.js";import"./UserOutlined-B6UgDNvg.js";import"./SettingOutlined-DqT4KVGu.js";import"./button-Cp0m0R1r.js";import"./render-Djj-c0hd.js";import"./HomeOutlined-C4OogkYc.js";import"./index-C3dhmG1F.js";import"./index-BsgWie2l.js";import"./CheckCircleFilled-D_EukWF0.js";import"./InfoCircleFilled-BMW40hVe.js";import"./useClosable-CwO_CrU1.js";import"./Skeleton-B12qev6_.js";import"./fade-BItBM9YX.js";import"./CalendarOutlined-D4FYCPT5.js";import"./index-Hmfw_UVg.js";import"./index-BS-wy02R.js";import"./DeleteOutlined-Dq-auXs9.js";import"./EyeOutlined-DQrokycp.js";import"./progress-B9A8WQ6T.js";import"./ProfileInfo-B9T426H7.js";import"./HeartOutlined-5WspGz6P.js";import"./TeamOutlined-BTOZ41sI.js";import"./InfoCircleOutlined-XQtj6wYH.js";import"./PhoneOutlined-CHMyuDpl.js";import"./UserEvents-CAGhULZ3.js";import"./index-CS9f7FJf.js";import"./EnvironmentOutlined-DE-SrpiR.js";import"./UserPoints-t5-fXU5K.js";import"./TrophyOutlined-B9Kg5Vco.js";import"./UpdateProfileInformationForm-D0n-1sud.js";import"./TextInput-DycoUuQ0.js";import"./InputLabel-Ds4p1MUc.js";import"./PrimaryButton-CwDSxNCe.js";import"./transition-qykz7rcQ.js";import"./UpdatePasswordForm-BH8Fxkbh.js";import"./DeleteUserForm-nMFgsapz.js";import"./index-Bhmjue4f.js";import"./index-BqH50av7.js";import"./index-CtsAKqtm.js";import"./context-DvQRYSUW.js";function He({mustVerifyEmail:v,status:E}){const{user:r,personalInformation:O,educationalBackground:R,additionalInformation:j,emergencyContact:x}=w().props,[y,p]=t.useState(!1),[m,b]=t.useState(null),[d,S]=t.useState(""),[l,_]=t.useState(""),[u,f]=t.useState({data:[],loading:!0,error:null}),[h,g]=t.useState({data:[],loading:!0,error:null});t.useEffect(()=>{(async()=>{try{const e=await c.get(route("your.events.fetch"),{headers:{Accept:"application/json"}});f({data:e.data||[],loading:!1,error:null})}catch(e){console.error("Full error:",e),e.response?(console.error("Response error:",e.response.data),console.error("Status code:",e.response.status)):e.request?console.error("No response received:",e.request):console.error("Error setting up request:",e.message),f({data:[],loading:!1,error:e.message||"Failed to fetch events"}),n.error("Error fetching events: "+e.message)}})()},[]),t.useEffect(()=>{(async()=>{try{const i=((await c.get(route("gcash.redemption.configs"),{headers:{Accept:"application/json","Content-Type":"application/json"}})).data||[]).filter(s=>s.points_required!==void 0&&s.gcash_amount!==void 0&&s.is_active).map(s=>({points:s.points_required,amount:s.gcash_amount}));g({data:i,loading:!1,error:null})}catch(e){console.error("Error fetching redemption options:",e),g({data:[],loading:!1,error:e.message||"Failed to fetch redemption options"}),n.error("Failed to load redemption options")}})()},[]);const C=o=>{(r==null?void 0:r.youth_points)>=o.points?(b(o),p(!0)):n.warning("Insufficient points for this redemption.")},q=async()=>{var o,e;try{const i=await c.post(route("gcash.redeem"),{points:m.points,amount:m.amount,gcash_name:d,gcash_number:l});n.success(i.data.message),p(!1)}catch(i){n.error(((e=(o=i.response)==null?void 0:o.data)==null?void 0:e.message)||"Redemption failed")}};return a.jsxs(M,{user:r,children:[a.jsx(G,{title:"View Profile"}),a.jsx(N,{user:r}),a.jsx(P,{user:r,personalInformation:O,educationalBackground:R,additionalInformation:j,emergencyContact:x,userEvents:u.data,isLoadingEvents:u.loading,redemptionOptions:h.data,isLoadingOptions:h.loading,handleOpenGCashModal:C,mustVerifyEmail:v,status:E}),a.jsx(V,{isVisible:y,onClose:()=>p(!1),selectedOption:m,gcashName:d,setGcashName:S,gcashNumber:l,setGcashNumber:_,onRedeem:q})]})}export{He as default};
